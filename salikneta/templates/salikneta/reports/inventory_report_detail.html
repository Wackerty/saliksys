`
{% load staticfiles %}
{% include 'salikneta/includes/head.html' %}
<body>
  <section id="container">

{% include request.session.header %}
 <!-- **********************************************************************************************************************************************************
        MAIN CONTENT
        *********************************************************************************************************************************************************** -->


<section id="main-content">
      <section class="wrapper">
        <div class="row mt">
          <div class="col-lg-12">
                <div class="pull-right" style="margin-top: 6vh;margin-right: 5vw"><button class="btn btn-default" onclick="printDiv('print_div')"> <i class="fa fa-print"></i> Print</button></div>
            <div class="form-panel" id="print_div" style="padding: 50px">
                <div class="row">
                    {% if gen_info == "low stock" %}

                        <h3 class="mb"><i class="fa fa-angle-right"></i> Inventory Low Stock Report ({{ request.session.branch }} branch)-</h3>
{#                        <div class="pull-right" style="margin-right: 2vw"><img src="{% static 'img/salikneta_ico.png' %}" alt="salikneta logo" width="100" height="80"></div>#}
                        <h4>Date: {{ datetime|date:"Y/m/d" }}</h4>
                        <h4>Time: {{ datetime|date:"H:i:s" }}</h4>
                    {% else %}
                        <h4 class="mb"><i class="fa fa-angle-right"></i> Inventory Audit Report ({{ request.session.branch }} branch)-</h4>
                        <h5>{{ gen_info.message }}</h5>
                        <h5>Total Backloads: {{ gen_info.total_backloads }}</h5>
                        <h5>Total Transfered In: {{ gen_info.transfer_in }}</h5>
                        <h5>Total Transfered Out: {{ gen_info.transfer_out }}</h5>
                        <h5>Total Sales Count: {{ gen_info.total_sales_ct }}</h5>
                    {% endif %}
                </div>
            <style>
              .bdr{
                  border: 1px;

              }
              .cell_bdr{
                  border: 1px solid black;
              }
              .txt_al_center{
                  text-align: center;
              }
              .txt_al_right{
                  text-align: right;
              }
          </style>
            {% if gen_info == "low stock" %}
                <table id="itm_tbl" class="table table-bordered table-striped table-condensed" style="width: 100%;border-width: 1px" >
                  <thead>
                    <tr>
                      <th>Product</th>
                      <th>UOM</th>
                      <th>Current Inventory</th>
                      <th>Re-order Level</th>
                    </tr>
                  </thead>
                  <tbody id ="sales_tbl">
                    {% for r in report_data %}
                        {% if r.unitsInStock < r.reorderLevel %}
                            <tr>
                                <td class="cell_bdr" style="border: 1px solid black">{{ r.product }}</td>
                                <td class="cell_bdr txt_al_center" style="border: 1px solid black">{{ r.uom }}</td>
                                <td class="cell_bdr txt_al_right" style="border: 1px solid black">{{ r.unitsInStock }}</td>
                                <td class="cell_bdr txt_al_right" style="border: 1px solid black">{{ r.reorderLevel }}</td>
                            </tr>
                        {% endif %}
                    {% endfor %}
                  </tbody>
                </table>
            {% else %}
                <table id="itm_tbl" class="table table-bordered table-striped table-condensed" style="width: 100%;border-width: 1px" >
                  <thead>
                    <tr>
                      <th>Product</th>
                      <th>Price</th>
                      <th>UOM</th>
                      <th>Beginning Inventory</th>
                      <th>Transfered In</th>
                      <th>Transfered Out</th>
                      <th>Backloads</th>
                      <th>Sales</th>
                      <th>Ending Inventory</th>
                    </tr>
                  </thead>
                  <tbody id ="sales_tbl">
                    {% for r in report_data %}
                      <tr>
                        <td class="cell_bdr" style="border: 1px solid black">{{ r.product }}</td>
                        <td class="cell_bdr" style="border: 1px solid black">{{ r.unit_price }}</td>
                        <td class="cell_bdr txt_al_center" style="border: 1px solid black">{{ r.uom }}</td>
                        <td class="cell_bdr txt_al_right" style="border: 1px solid black">{{ r.beg_inv }}</td>
                        <td class="cell_bdr txt_al_right" style="border: 1px solid black">{{ r.transfer_in }}</td>
                        <td class="cell_bdr txt_al_right" style="border: 1px solid black">{{ r.transfer_out }}</td>
                        <td class="cell_bdr txt_al_right" style="border: 1px solid black">{{ r.returns }}</td>
                        <td class="cell_bdr txt_al_right" style="border: 1px solid black">{{ r.sales }}</td>
                        <td class="cell_bdr txt_al_right" style="border: 1px solid black">{{ r.end_inv }}</td>
                      </tr>
                    {% endfor %}
                  </tbody>
                </table>
            {% endif %}
            </div>
          </div>
        </div>
      </section>
</section>
</section>
</body>
<script>
    function printDiv(div) {
        var printStr = "<script>"+"window.print();</"+"script>";
        var printCont = document.getElementById(div);
        var html = '<html><head>'+
               '<title>Inventory Report {{ gen_info.message }}</title>'+
               '</head><body style="background:#ffffff;">'+
               '<img src="/static/img/salikneta_ico.png" alt="salikneta logo" width="100" height="100" align="right">'+
               printCont.innerHTML+
               '</body></html>'+printStr;
        var WindowObject =window.open('',"Print Window",
            "width=1000,height=1000,top=200, left=200, toolbars=no, scrollbars=no,resizable=no");
        WindowObject.document.writeln(html);
        WindowObject.document.close();
        WindowObject.focus();
        WindowObject.print();
        WindowObject.close();
    }
    function show_modal_invoice(id,obj){
        $("#receipt_tbl").empty();
        $("#modal-in-date").html("INVOICE DATE: "+$(obj).attr("i_date"));
        $("#modal-in-num").html("INVOICE NO: "+$(obj).attr("i_num"));
        $("#r_net_total").html($(obj).attr("i_total"));
           let invoice_data =  $.get("/salikneta/ajax/get_invoicelines_by_salesid/"+id+"/");
           invoice_data.done(function(results){
                obj = results.data;
                for (i in obj){
                  str = '<tr id="r_item_'+'">';
                  str +='<td class="text-center"  style="border: 1px solid black;text-align: center" id="r_qty_'+'">'+obj[i].qty+'</td>';
                  str +='<td class="text-center"  style="border: 1px solid black;text-align: center">'+obj[i].uom+'</td>';
                  str +='<td style="border: 1px solid black;text-align: center">'+obj[i].productName+'</td>';
                  str +='<td class="text-right"  style="border: 1px solid black;text-align: right">P'+obj[i].unitPrice+'</td>';
                  str +='<td class="text-right" style="border: 1px solid black;text-align: right"><b id="r_disc_'+'">'+obj[i].disc+'</b>%</td>';
                  str += '<td class="text-right" style="border: 1px solid black;text-align: right">P<b id="r_amt_'+'">'+obj[i].net_price+'</b></td>';
                  str +='</tr>';
                  $("#receipt_tbl").append(str);
                }
           });
    }
</script>
<script>
    $(document).ready(function() {
        $('#itm_tbl').DataTable({
            searching: false,
            paging: false,
            info: false
        });
    });
</script>
            <!--custom chart end-->